# Уже 27 февраля, а у меня только дошли руки до проекта
Для анализа я нашел датасет с [kaggle](https://www.kaggle.com/datasets/lainguyn123/student-performance-factors/data). Датасет включает в себя 20 колонок и 6607 наблюдений, каждое из которых относится к одному из опрошенных студентов. Я выбрал этот датасет, потому что мне очень хотелось построить какую-нибудь ml-модель
# Описание переменных:
1. Hours_Studied (числовая) - количество часов, которое студент тратит на обучение в неделю
2. Attendance (числовая) - процентная доля посещенных занятий
3. Parental_Involvement (категориальная) - Уровень участия родителей в обучении студента (Low, Medium, High)
4. Access_to_Resources (категориальная) - Доступность образовательных ресурсов (Low, Medium, High)
5. Extracurricular_Activities (категориальная) - Участие студента во внеурочной деятельности (Yes, No)
6. Sleep_Hours (числовая) - Среднее количество часов сна в день
7. Previous_Scores (числовая) - Средняя оценка за предыдущие экзамены
8. Motivation_Level (категориальная) - Уровень мотивации ученика (Low, Medium, High)
9. Internet_Access (категориальная) - Доступ студента к интернету (Yes, No). *У 500 студентов нет доступа к интернету, как они живут вообще*.
10. Tutoring_Sessions (числовая) - Количество занятий с репетитором в месяц
11. Family_Income (категориальная) - Уровень дохода семьи (Low, Medium, High)
12. Teacher_Quality (категориальная) - Качество преподавания (Low, Medium, High)
13. School_Type (категориальная) - Тип школы (Public, Private)
14. Peer_Influence (категориальная) - Влияние сверстников на академические успехи (Positive, Neutral, Negative)
15. Physical_Activity (числовая) - число часов, затрачиваемое на физическую активность в неделю
16. Learning_Disabilities (категориальная) - Наличие трудностей в обучении (Yes, No)
17. Parental_Education_Level (категориальная) - Наивысший уровень образования у родителей (High School, College, Postgraduate)
18. Distance_from_Home (категориальная) - Расстояние от дома до школы (Near, Moderate, Far)
19. Gender (категориальная) - Пол студента (Male, Female)
20. Exam_Score (числовая) - Результат финального экзамена

# Работа с пропусками
Пропуски содержатся в трех колонках: Teacher_Quality, Parental_Education_Level, Distance_from_Home. Так как каждая из этих переменных категориальная, а пропусков немного, я заполню их модой. Однако, я не хочу спешить с переменной Parental_Education_Level, для начала я хочу проверить, есть ли связь между этой переменной и Family_Income. Для этого я построю тепловую карту, предварительно создав сводную таблицу для этих переменных
![image](https://github.com/user-attachments/assets/6104ad44-2caa-43a9-9acb-e3d24b2e77e5)  
Судя по тепловой карте, между переменными нет явной зависимости, так как в каждом уровне дохода наиболее популярный уровень образования у родителей - High School. Остальные уровни образования распределены +- одинаково во всех доходных группах. По этой причине я заполню пропуски в переменной Parental_Education_Level модой
# Новые переменные
Из переменных, которые можно было бы добавить, я выделил динамику оценки за экзамен, то есть разницу между результатом финального экзамена и средней оценкой за предыдущие. Так же все категориальные переменные я бы хотел перевести в числовые, чтобы было легче строить ml-модель.  
Для этого я напишу функцию, которая переводит категориальные переменные со значениями [Low, Medium, High] в соответствующие [0, 1, 2]  
Аналогично я заменю все остальные категориальные переменные.  
# Возможные зависимости  
Мне в голову пришло несколько пар переменных, связь между которыми можно изучить.  
1. Family_Income - Tutoring_Sessions.
   Чем выше уровень дохода у родителей, тем больше занятий с репетитором в месяц они могут себе позволить. Для выявления возможной зависимости я построю ящик с усами ![image](https://github.com/user-attachments/assets/54e32424-3030-4f08-98e7-03cb4fbb28e1)
   Как видно по ящику, медианы переменных почти не различаются, как и межквартильные размахи, то есть связь слабая. Выбросы распределены равномерно.
   Вывод: взаимосвязи между переменными, скорее всего, нет
   2. Peer_Influence - Motivation_Level.
   Чем лучше влияние сверстников - тем выше мотивация учиться. Для выявления возможной зависимости я построил violin plot
   ![image](https://github.com/user-attachments/assets/d228857c-c426-4242-b8db-11175766d8c4)  
   Как можно заметить из графика, явной зависимости между переменными нет, так как распределения в каждой из групп схожи. Также у студентов с негативным влиянием сверстников больше людей с высокой мотивацией. Очень сомнительный результат.
3. Physical_Activity - Sleep_Hours.
   Теоретически, регулярная физическая активность может оказывать положительное влияние на качество сна и его количество. По предположениям, регулярные занятия спортом повышают качество сна, однако если уделять этому слишком много времени, то это может иметь обратный эффект. Чтобы проверить это, построю столбчатую диаграмму. 
![image](https://github.com/user-attachments/assets/a2d7286f-4068-4b02-8e6a-0cb4ba1db228)
Студенты, занимающиеся физической активностью 6 часов в неделю, больше высыпаются. Также можно заметить скачок по количеству сна для студентов, которые совсем не занимаются спортом. Меньше всего спят студенты, уделяющие спорту 1 и 5 часов в неделю. Мое предположение частично подтвердилось: спортсмены действительно спят лучше, однако чрезмерные физические нагрузки не оказывают обратный эффект. У людей же, которые не занимаются спортом вовсе, попросту больше времени на неделе, поэтому средние часы сна выше. 
# Гипотезы
Несмотря на то, что визуализация не показала явной зависимости между переменными, я бы хотел еще раз убедиться в этом с помощью мат статистики.  
1. Family_Income - Tutoring_Sessions
   Чтобы сравнить эти переменные, я использую тест ANOVA.
   Я выбрал его, поскольку Family_income принимает 3 уровня значений [0,1,2] - она является независимой категориальной переменной. Tutoring_Sessions является целочисленной зависимой переменной, то есть формат данных идеально подходит для теста. Я буду сравнивать средние значения Tutoring_Sessions при разных уровнях дохода. 
2. Peer_Influence - Motivation_Level
   Чтобы проверить связь между этими переменными, я буду использовать тест хи-квадрат, чтобы убедиться в наличии связи, поскольку это две категориальные переменные. Затем, если связь действительно есть, я использую коэффициент Крамера, чтобы выявить, насколько она сильна
3. Physical_Activity - Sleep_Hours
   Так как обе переменные числовые, я проверю наличие зависимости через коэффициенты корелляции Пирсона и Спирмена. 
# Family_Income - Tutoring_Sessions  
Для начала я сгруппировал переменные по уровню дохода, чтобы с ними было удобнее работать (соответственно group_0, group_1, group_2). Затем я проверю распределение данных с помощью теста Шапиро-Уилка.  
Результаты теста получились плачевными для меня, поскольку значения pvalue крайне малы, значит данные не распределены нормально, так что я не могу использовать тест ANOVA для этих переменных. Для дальнейшего анализа этих переменных я буду использовать тест Краскела-Уоллиса, так как он не требует нормального распределения данных. 
К сожалению, тест дал отрицательный результат на зависимость между переменными, поскольку значение pvalue слишком велико  
Вывод: Количество занятий студента с репетитором не зависит от уровня дохода семьи.
# Peer_Influence - Motivation_Level
Перед проведением теста хи-квадрат я строю таблицу сопряженности по переменным. Затем применяю тест.  
значение p оказалось слишком велико (~0.326), поэтому можно утверждать, что статистической связи между переменными нет.  
Чтобы повторно в этом убедиться, я также провел вычеслил коэффициент Крамера, который оказался равным ~0.019, то есть близкий к нулю.
# Physical_Activity - Sleep_Hours
Я посчитал коэффициенты корелляции Пирсона и Спирмена, и моя гипотеза не подтвердилась. Значения коэффициентов оказались близки к нулю, значит связи между переменными нет.
# ML
Я решил написать модель линейной регрессии, чтобы предсказать переменную Exam_Score. Для начала я удалил из выборки переменную Performance_Change, поскольку при ее наличии предсказать переменную Exam_Score можно будет идеально точно по переменным Previous_Scores и Performance_Change (ну очевидно). Затем разделил данные на две выборки со стандартным отношением 80 на 20 и приступил к обучению модели.  
Чтобы лучше интерпретировать коэффициент MSE я посмотрел разброс значений переменной Exam_Score. Значения варьируются от 55 д 101, но посмотрев на распределение данных по этим значениям у меня появилось предположение, что в данных могут быть выбросы (можно было сделать это и до построения модели, конечно же, но я затупил).  
Выбросы я сортировал квартильным методом. Таким способом обнаружилось 104 выброса. Я попробую удалить их из выборки и заново обучить модель.  
Как и предполагалось, при отсутствии выбросов эффективность модели улучшилась (даже очень сильно улучшилась). Показатель MSE всего 0.24, а R^2 98%.  
Из наблюдений: Наиболее весомые переменные - Влияние родителей, доступ к образовательным ресурсам и доступ к интернету. Наиболее весомые отрицательные переменные - Наличие затруднений в обучениию. Также можно заметить, что пол почти никак не сказывается на результатах, как и тип школы, и, к моему удивлению, количество часов сна.
